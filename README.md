# Broadband- Please run in MATLAB
An algorithm for procuring maximum utility of Energy Harvesting Sensors (EHS) that operate purely on the basis of the energy harvested from the surroundings while maintaining the Energy Neutrality constraint. The algorithm is designed in two stages viz. the Inner stage and the Outer stage. The former focusses on maximizing the rate of transmission for a power constraint imposed by the latter. The outer stage is responsible for preserving the energy neutrality constraint. The two-stage architecture uses the difference in the timescales of evolution of the harvested power and the channel, without loss of optimality of the resulting solution. Various distributions like Uniform, Gaussian and Exponential were considered for modelling the energy harvesting profile and their impact on transmission rate were compared for the case of Rayleigh fading channels. The consequence of employing Water filling algorithm for obtaining maximum rate of transmission under different constant harvested power durations are illustrated via simulations. The communication parameters are optimized for different fixed rate transmission strategies like Truncated Channel Inversion (TCI) and Retransmission schemes. The results demonstrate that the Water filling algorithm gives much better transmission rates for tighter power constraint set by the outer stage.
1.INNER STAGE: The goal of the inner stage is to obtain the maximum utility given the power constraint set by the outer stage. Fixed data rate transmission strategies like Truncated Channel Inversion and Retransmission methods are considered for analysis. The system follows IEEE 802.15.4 (Low Rate-WPAN)communication standard. The solution to the above problem will reduce to optimization of duty cycle and the channel gain thresholds to maximize the average data rate.
1.1 Truncated Channel Inversion: In this method, the channel between the EHS and the destination is estimated accurately using a high-power pilot signal from the destination. The sensor transmits data at a power proportional to the inverse of the channel gain Γ, provided Γ exceeds a threshold Γm at a fixed rate Ron. The channel magnitude is assumed to be perfectly reciprocal which is possible with well-calibrated RF components.
1.2 Retransmission scheme: In this scheme, the EHS transmits the packets at a constant power Pt and a fixed rate Ron repeatedly until it receives an acknowledgement from the destination. Power required to receive the acknowledgement is included in the fixed power consumption of the circuitry Pf.Goal is to find the values of Γr and D that maximize the average data rate Ra
1.3 Water Filling Algorithm: This is an extension of the existing dual-stage algorithm. In this method, the power allocated to the sensor for transmission is evaluated based on the channel threshold gain (in case of TCI). Even though, employing this method consumes extra power, it gives a better rate of transmission compared to the normal case as proved by the simulations.
2. OUTER STAGE DESIGN: The outer stage works with the aim of maintaining energy neutrality over a long time period by controlling the power used by the inner stage. We have already stated that the energy harvesting process is considered to be stationary and ergodic and the harvested energy is stored in an inefficient battery for future use. We estimate the battery capacity required to handle the variations in the harvested power for all the distributions and time slots under consideration. Inner stage performance is abstracted as a concave function of the power allocated. In the analysis, the optimum solution in the outer stage is shown to be the clipped version of the harvested power. The lower and the upper clipping thresholds are chosen such that the long term energy neutrality constraint is met and also the utility is maximized. This stage imposes Energy Neutrality Constraint to the system which is, “The long-term average energy consumed by the system should be equal to the long-term average energy harvested”. 
3. ENERGY NEUTRALITY: The energy neutrality constraint considered in this project maybe described as follows. When Pa > Ph, Pa − Ph amount of power is used from the battery, which suffers the loss due to the efficiency factor, i.e., the actual amount of power consumed is ￼ . If Pa < Ph, Ph − Pa is deposited into the battery.
